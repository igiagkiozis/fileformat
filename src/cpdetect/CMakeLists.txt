cmake_minimum_required(VERSION 3.9)

set(CPDETECT_SOURCES
	compiler_detector/coff_compiler.cpp
	compiler_detector/compiler_detector.cpp
	compiler_detector/elf_compiler.cpp
	compiler_detector/heuristics/elf_heuristics.cpp
	compiler_detector/heuristics/heuristics.cpp
	compiler_detector/heuristics/macho_heuristics.cpp
	compiler_detector/heuristics/pe_heuristics.cpp
	compiler_detector/intel_hex_compiler.cpp
	compiler_detector/macho_compiler.cpp
	compiler_detector/pe_compiler.cpp
	compiler_detector/raw_data_compiler.cpp
	compiler_detector/search/search.cpp
	compiler_factory.cpp
	cptypes.cpp
	errors.cpp
	signatures/avg/signature.cpp
	signatures/avg/signature_checker.cpp
	signatures/yara/database/arm/elf/compiler.cpp
	signatures/yara/database/arm/elf/packer.cpp
	signatures/yara/database/arm/macho/compiler.cpp
	signatures/yara/database/arm/macho/packer.cpp
	signatures/yara/database/arm/pe/compiler.cpp
	signatures/yara/database/arm/pe/packer.cpp
	signatures/yara/database/database.cpp
	signatures/yara/database/mips/elf/compiler.cpp
	signatures/yara/database/mips/elf/packer.cpp
	signatures/yara/database/mips/macho/compiler.cpp
	signatures/yara/database/mips/macho/packer.cpp
	signatures/yara/database/mips/pe/compiler.cpp
	signatures/yara/database/mips/pe/packer.cpp
	signatures/yara/database/powerpc/elf/compiler.cpp
	signatures/yara/database/powerpc/elf/packer.cpp
	signatures/yara/database/powerpc/macho/compiler.cpp
	signatures/yara/database/powerpc/macho/packer.cpp
	signatures/yara/database/powerpc/pe/compiler.cpp
	signatures/yara/database/powerpc/pe/packer.cpp
	signatures/yara/database/x86/elf/compiler_01.cpp
	signatures/yara/database/x86/elf/compiler_02.cpp
	signatures/yara/database/x86/elf/packer.cpp
	signatures/yara/database/x86/macho/compiler.cpp
	signatures/yara/database/x86/macho/packer.cpp
	signatures/yara/database/x86/pe/compiler/compiler_01.cpp
	signatures/yara/database/x86/pe/compiler/compiler_02.cpp
	signatures/yara/database/x86/pe/compiler/compiler_03.cpp
	signatures/yara/database/x86/pe/compiler/compiler_04.cpp
	signatures/yara/database/x86/pe/compiler/compiler_05.cpp
	signatures/yara/database/x86/pe/compiler/compiler_06.cpp
	signatures/yara/database/x86/pe/compiler/compiler_07.cpp
	signatures/yara/database/x86/pe/compiler/compiler_08.cpp
	signatures/yara/database/x86/pe/compiler/compiler_09.cpp
	signatures/yara/database/x86/pe/compiler/compiler_10.cpp
	signatures/yara/database/x86/pe/packer/packer_01.cpp
	signatures/yara/database/x86/pe/packer/packer_02.cpp
	signatures/yara/database/x86/pe/packer/packer_03.cpp
	signatures/yara/database/x86/pe/packer/packer_04.cpp
	signatures/yara/database/x86/pe/packer/packer_05.cpp
	signatures/yara/database/x86/pe/packer/packer_06.cpp
	signatures/yara/database/x86/pe/packer/packer_07.cpp
	signatures/yara/database/x86/pe/packer/packer_08.cpp
	signatures/yara/database/x86/pe/packer/packer_09.cpp
	signatures/yara/database/x86/pe/packer/packer_10.cpp
	signatures/yara/database/x86/pe/packer/packer_11.cpp
	signatures/yara/database/x86/pe/packer/packer_12.cpp
	signatures/yara/database/x86/pe/packer/packer_13.cpp
	signatures/yara/database/x86/pe/packer/packer_14.cpp
	signatures/yara/database/x86/pe/packer/packer_15.cpp
	signatures/yara/database/x86/pe/packer/packer_16.cpp
	signatures/yara/database/x86/pe/packer/packer_17.cpp
	signatures/yara/database/x86/pe/packer/packer_18.cpp
	signatures/yara/database/x86/pe/packer/packer_19.cpp
	signatures/yara/database/x86/pe/packer/packer_20.cpp
	signatures/yara/database/x86/pe/packer/packer_21.cpp
	signatures/yara/database/x86/pe/packer/packer_22.cpp
	signatures/yara/database/x86/pe/packer/packer_23.cpp
	signatures/yara/database/x86/pe/packer/packer_24.cpp
	signatures/yara/database/x86/pe/packer/packer_25.cpp
	signatures/yara/database/x86/pe/packer/packer_26.cpp
	signatures/yara/database/x86/pe/packer/packer_27.cpp
	signatures/yara/database/x86/pe/packer/packer_28.cpp
	signatures/yara/database/x86/pe/packer/packer_29.cpp
	signatures/yara/database/x86/pe/packer/packer_30.cpp
	signatures/yara/database/x86/pe/packer/packer_31.cpp
	signatures/yara/database/x86/pe/packer/packer_32.cpp
	signatures/yara/database/x86/pe/packer/packer_33.cpp
	signatures/yara/database/x86/pe/packer/packer_34.cpp
	signatures/yara/database/x86/pe/packer/packer_35.cpp
	signatures/yara/database/x86/pe/packer/packer_36.cpp
	signatures/yara/database/x86/pe/packer/packer_37.cpp
	signatures/yara/database/x86/pe/packer/packer_38.cpp
	signatures/yara/database/x86/pe/packer/packer_39.cpp
	signatures/yara/database/x86/pe/packer/packer_40.cpp
	signatures/yara/database/x86/pe/packer/packer_41.cpp
	signatures/yara/database/x86/pe/packer/packer_42.cpp
	signatures/yara/database/x86/pe/packer/packer_43.cpp
	signatures/yara/database/x86/pe/packer/packer_44.cpp
	signatures/yara/database/x86/pe/packer/packer_45.cpp
	signatures/yara/database/x86/pe/packer/packer_46.cpp
	signatures/yara/database/x86/pe/packer/packer_47.cpp
	signatures/yara/database/x86/pe/packer/packer_48.cpp
	signatures/yara/database/x86/pe/packer/packer_49.cpp
	signatures/yara/database/x86/pe/packer/packer_50.cpp
	signatures/yara/database/x86/pe/packer/packer_51.cpp
	signatures/yara/database/x86/pe/packer/packer_52.cpp
	signatures/yara/database/x86/pe/packer/packer_53.cpp
	signatures/yara/database/x86/pe/packer/packer_54.cpp
	signatures/yara/database/x86/pe/packer/packer_55.cpp
	signatures/yara/database/x86/pe/packer/packer_56.cpp
	signatures/yara/database/x86/pe/packer/packer_57.cpp
	signatures/yara/database/x86/pe/packer/packer_58.cpp
	signatures/yara/database/x86/pe/packer/packer_59.cpp
	signatures/yara/database/x86/pe/packer/packer_60.cpp
	signatures/yara/database/x86/pe/packer/packer_61.cpp
	signatures/yara/database/x86/pe/packer/packer_62.cpp
	signatures/yara/database/x86/pe/packer/packer_63.cpp
	signatures/yara/database/x86/pe/packer/packer_64.cpp
	signatures/yara/database/x86/pe/packer/packer_65.cpp
	signatures/yara/database/x86/pe/packer/packer_66.cpp
	signatures/yara/database/x86/pe/packer/packer_67.cpp
	signatures/yara/database/x86/pe/packer/packer_68.cpp
	signatures/yara/database/x86/pe/packer/packer_69.cpp
	signatures/yara/database/x86/pe/packer/packer_70.cpp
	signatures/yara/database/x86/pe/packer/packer_71.cpp
	utils/version_solver.cpp
)

if(NOT TARGET cpdetect)

	add_library(cpdetect STATIC ${CPDETECT_SOURCES})
	target_link_libraries(cpdetect libdwarf fileformat yaracpp tinyxml2)
	target_include_directories(cpdetect PUBLIC ${PROJECT_SOURCE_DIR}/include/)

endif()
